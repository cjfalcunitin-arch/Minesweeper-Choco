<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Minesweeper Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        .screen {
            display: none;
            min-height: 100vh;
        }

        .screen.active {
            display: flex;
        }

        /* Loading Screen */
        #loadingScreen {
            background: linear-gradient(to bottom, #1e293b, #14b8a6);
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .chess-pieces {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .chess-piece {
            width: 6rem;
            height: 8rem;
            border-radius: 0.5rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            border: 4px solid;
        }

        .piece-flag {
            background: linear-gradient(to bottom, #4b5563, #1f2937);
            border-color: #6b7280;
        }

        .piece-crown {
            background: linear-gradient(to bottom, #fbbf24, #d97706);
            border-color: #f59e0b;
        }

        .loading-text {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 2rem;
        }

        .progress-bar {
            width: 20rem;
            height: 1rem;
            background: #374151;
            border-radius: 9999px;
            border: 2px solid #d97706;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #10b981, #34d399);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Menu Screen */
        #menuScreen {
            background: linear-gradient(to bottom, #1e293b, #14b8a6);
            flex-direction: column;
        }

        .header {
            background: linear-gradient(to right, #b45309, #92400e);
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 4px solid #d97706;
        }

        .profile-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: linear-gradient(to bottom, #d1d5db, #6b7280);
            border: 2px solid #fbbf24;
        }

        .settings-btn {
            width: 2.5rem;
            height: 2.5rem;
            background: #dc2626;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            border: none;
            color: #fbbf24;
            font-size: 1.5rem;
        }

        .menu-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .menu-title {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 2rem;
            text-align: center;
        }

        .button-container {
            width: 100%;
            max-width: 28rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .menu-button {
            width: 100%;
            background: linear-gradient(to bottom, #10b981, #059669);
            color: white;
            font-weight: bold;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            border: 4px solid #047857;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            font-size: 1.25rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .menu-button:hover {
            transform: scale(1.05);
        }

        .menu-button.cyan {
            background: linear-gradient(to bottom, #06b6d4, #0891b2);
            border-color: #0e7490;
        }

        .icon {
            width: 1.5rem;
            height: 1.5rem;
        }

        /* Difficulty Screen */
        .difficulty-screen {
            background: linear-gradient(to bottom, #1e293b, #14b8a6);
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .difficulty-button {
            width: 100%;
            color: white;
            font-weight: bold;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            border: 4px solid;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.2s;
        }

        .difficulty-button:hover {
            transform: scale(1.02);
        }

        .difficulty-button.easy {
            background: linear-gradient(to bottom, #4ade80, #22c55e);
            border-color: #16a34a;
        }

        .difficulty-button.medium {
            background: linear-gradient(to bottom, #facc15, #eab308);
            border-color: #ca8a04;
        }

        .difficulty-button.hard {
            background: linear-gradient(to bottom, #fb923c, #f97316);
            border-color: #ea580c;
        }

        .difficulty-button.expert {
            background: linear-gradient(to bottom, #f87171, #ef4444);
            border-color: #dc2626;
        }

        .back-button {
            background: linear-gradient(to bottom, #6b7280, #4b5563);
            border-color: #374151;
        }

        /* Game Screen */
        #gameScreen {
            background: linear-gradient(to bottom, #1e293b, #14b8a6);
            flex-direction: column;
        }

        .game-header {
            background: linear-gradient(to right, #b45309, #92400e);
            padding: 1rem;
            border-bottom: 4px solid #d97706;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .icon-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 0.5rem;
            transition: transform 0.2s;
        }

        .icon-button:hover {
            transform: scale(1.1);
        }

        .timer-display {
            background: #1e293b;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .timer-text {
            color: white;
            font-weight: bold;
        }

        /* VS AI Progress */
        .race-progress {
            background: #1e293b;
            padding: 1rem;
        }

        .race-title {
            color: white;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .progress-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .progress-label {
            font-size: 0.875rem;
            font-weight: bold;
            width: 4rem;
        }

        .progress-label.player {
            color: #4ade80;
        }

        .progress-label.ai {
            color: #9ca3af;
        }

        .progress-track {
            flex: 1;
            height: 1.5rem;
            background: #374151;
            border-radius: 9999px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            transition: width 0.2s;
        }

        .progress-bar-fill.player {
            background: #22c55e;
        }

        .progress-bar-fill.ai {
            background: #ef4444;
        }

        .progress-percent {
            color: white;
            font-size: 0.875rem;
            width: 3rem;
            text-align: right;
        }

        /* Game Content */
        .game-content {
            flex: 1;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        .flag-container {
            width: 4rem;
            height: 4rem;
            background: #dc2626;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            cursor: move;
            border: 4px solid #991b1b;
            margin-bottom: 1rem;
            transition: transform 0.2s;
            touch-action: none;
        }

        .flag-container:hover {
            transform: scale(1.1);
        }

        .flag-container.dragging {
            opacity: 0.5;
        }

        .board-container {
            overflow: auto;
            max-height: calc(100vh - 300px);
            border-radius: 0.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            background: #0f172a;
            padding: 0.5rem;
            -webkit-overflow-scrolling: touch;
        }

        .board {
            display: inline-block;
        }

        .board-row {
            display: flex;
        }

        .cell {
            border: 1px solid #475569;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s;
            user-select: none;
        }

        .cell.hidden {
            background: linear-gradient(to bottom, #94a3b8, #64748b);
        }

        .cell.hidden:hover {
            background: linear-gradient(to bottom, #cbd5e1, #94a3b8);
        }

        .cell.revealed {
            background: #334155;
        }

        .cell.mine {
            background: #dc2626;
        }

        .cell-1 { color: #3b82f6; }
        .cell-2 { color: #22c55e; }
        .cell-3 { color: #ef4444; }
        .cell-4 { color: #8b5cf6; }
        .cell-5 { color: #f97316; }
        .cell-6 { color: #06b6d4; }
        .cell-7 { color: #000; }
        .cell-8 { color: #6b7280; }

        /* Game Over Modal */
        .game-over {
            margin-top: 1rem;
            background: #1e293b;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 4px solid #fbbf24;
            text-align: center;
        }

        .game-over-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .game-over-title.win {
            color: #4ade80;
        }

        .game-over-title.lose {
            color: #ef4444;
        }

        .game-over-text {
            color: white;
            margin-bottom: 1rem;
        }

        .replay-button {
            background: linear-gradient(to bottom, #10b981, #059669);
            color: white;
            font-weight: bold;
            padding: 0.75rem 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            border: 4px solid #047857;
            cursor: pointer;
            font-size: 1rem;
        }

        /* Tutorial Screen */
        .tutorial-screen {
            background: linear-gradient(to bottom, #1e293b, #14b8a6);
            flex-direction: column;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .tutorial-content {
            background: #334155;
            border-radius: 0.75rem;
            padding: 1.5rem;
            max-width: 42rem;
            margin: 0 auto;
            color: white;
        }

        .tutorial-section {
            border-bottom: 1px solid #475569;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .tutorial-section:last-of-type {
            border-bottom: none;
        }

        .tutorial-subtitle {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tutorial-text {
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 640px) {
            .menu-title {
                font-size: 1.5rem;
            }

            .menu-button {
                font-size: 1rem;
                padding: 0.875rem 1rem;
            }

            .chess-piece {
                width: 5rem;
                height: 6.5rem;
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="screen active">
        <div class="chess-pieces">
            <div class="chess-piece piece-flag">üö©</div>
            <div class="chess-piece piece-crown">üëë</div>
        </div>
        <div class="loading-text">LOADING...</div>
        <div class="progress-bar">
            <div class="progress-fill" id="loadingProgress"></div>
        </div>
    </div>

    <!-- Menu Screen -->
    <div id="menuScreen" class="screen">
        <div class="header">
            <div class="profile-icon"></div>
            <button class="settings-btn">‚öôÔ∏è</button>
        </div>
        <div class="menu-content">
            <div class="chess-pieces">
                <div class="chess-piece piece-flag" style="width: 5rem; height: 7rem; font-size: 2.5rem;">üö©</div>
                <div class="chess-piece piece-crown" style="width: 5rem; height: 7rem; font-size: 2.5rem;">üëë</div>
            </div>
            <h2 class="menu-title">CHOOSE YOUR MODE</h2>
            <div class="button-container">
                <button class="menu-button" onclick="showScreen('normalDifficulty')">
                    <span class="icon">‚¨ú</span>
                    <span>PLAY NORMAL</span>
                </button>
                <button class="menu-button cyan" onclick="showScreen('timerDifficulty')">
                    <span class="icon">‚è±Ô∏è</span>
                    <span>TIMER MODE</span>
                </button>
                <button class="menu-button cyan" onclick="showScreen('vsaiDifficulty')">
                    <span class="icon">üë•</span>
                    <span>VS AI RACE</span>
                </button>
                <button class="menu-button cyan" onclick="showScreen('tutorial')">
                    <span class="icon">üìñ</span>
                    <span>HOW TO PLAY</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Normal Difficulty Screen -->
    <div id="normalDifficulty" class="screen difficulty-screen">
        <h2 class="menu-title">SELECT DIFFICULTY</h2>
        <div class="button-container">
            <button class="difficulty-button easy" onclick="startGame('normal', 'easy')">EASY (10x5 - 10 mines)</button>
            <button class="difficulty-button medium" onclick="startGame('normal', 'medium')">MEDIUM (10x10 - 20 mines)</button>
            <button class="difficulty-button hard" onclick="startGame('normal', 'hard')">HARD (10x15 - 30 mines)</button>
            <button class="difficulty-button expert" onclick="startGame('normal', 'expert')">EXPERT (10x20 - 40 mines)</button>
            <button class="difficulty-button back-button" onclick="showScreen('menu')">BACK</button>
        </div>
    </div>

    <!-- Timer Difficulty Screen -->
    <div id="timerDifficulty" class="screen difficulty-screen">
        <h2 class="menu-title">SELECT DIFFICULTY</h2>
        <p style="color: white; text-align: center; margin-bottom: 2rem;">Then choose time limit</p>
        <div class="button-container">
            <button class="difficulty-button easy" onclick="selectTimerDifficulty('easy')">EASY (10x5)</button>
            <button class="difficulty-button medium" onclick="selectTimerDifficulty('medium')">MEDIUM (10x10)</button>
            <button class="difficulty-button hard" onclick="selectTimerDifficulty('hard')">HARD (10x15)</button>
            <button class="difficulty-button expert" onclick="selectTimerDifficulty('expert')">EXPERT (10x20)</button>
            <button class="difficulty-button back-button" onclick="showScreen('menu')">BACK</button>
        </div>
    </div>

    <!-- Timer Time Selection Screen -->
    <div id="timerTime" class="screen difficulty-screen">
        <h2 class="menu-title">SELECT TIME LIMIT</h2>
        <div class="button-container">
            <button class="difficulty-button cyan" onclick="startTimerGame(1)">1 MINUTE</button>
            <button class="difficulty-button cyan" onclick="startTimerGame(2)">2 MINUTES</button>
            <button class="difficulty-button cyan" onclick="startTimerGame(3)">3 MINUTES</button>
            <button class="difficulty-button cyan" onclick="startTimerGame(5)">5 MINUTES</button>
            <button class="difficulty-button back-button" onclick="showScreen('timerDifficulty')">BACK</button>
        </div>
    </div>

    <!-- VS AI Difficulty Screen -->
    <div id="vsaiDifficulty" class="screen difficulty-screen">
        <h2 class="menu-title">SELECT DIFFICULTY</h2>
        <div class="button-container">
            <button class="difficulty-button easy" onclick="startGame('vsai', 'easy')">EASY (10x5 - 10 mines)</button>
            <button class="difficulty-button medium" onclick="startGame('vsai', 'medium')">MEDIUM (10x10 - 20 mines)</button>
            <button class="difficulty-button hard" onclick="startGame('vsai', 'hard')">HARD (10x15 - 30 mines)</button>
            <button class="difficulty-button expert" onclick="startGame('vsai', 'expert')">EXPERT (10x20 - 40 mines)</button>
            <button class="difficulty-button back-button" onclick="showScreen('menu')">BACK</button>
        </div>
    </div>

    <!-- Tutorial Screen -->
    <div id="tutorial" class="screen tutorial-screen">
        <h2 class="menu-title">HOW TO PLAY</h2>
        <div class="tutorial-content">
            <div class="tutorial-section">
                <h3 class="tutorial-subtitle">‚¨ú Basic Rules</h3>
                <p class="tutorial-text">Uncover all tiles without hitting a mine. Numbers show how many mines are adjacent to that tile.</p>
            </div>
            <div class="tutorial-section">
                <h3 class="tutorial-subtitle">üö© Using Flags</h3>
                <p class="tutorial-text">Drag and drop the flag from the top onto tiles you think contain mines. This helps you mark dangerous spots.</p>
            </div>
            <div class="tutorial-section">
                <h3 class="tutorial-subtitle">üéÆ Game Modes</h3>
                <p class="tutorial-text"><strong>Normal:</strong> Classic minesweeper with no time limit.</p>
                <p class="tutorial-text"><strong>Timer:</strong> Race against the clock to clear the board.</p>
                <p class="tutorial-text"><strong>VS AI:</strong> Compete against 5 AI opponents to finish first.</p>
            </div>
            <button class="difficulty-button easy" onclick="showScreen('menu')" style="margin-top: 1rem;">GOT IT!</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <div class="game-header">
            <button class="icon-button" onclick="showScreen('menu')">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            </button>
            <div class="header-controls">
                <div id="timerDisplay" class="timer-display" style="display: none;">
                    <span>‚è±Ô∏è</span>
                    <span class="timer-text" id="timerText">0:00</span>
                </div>
                <button class="icon-button" onclick="restartGame()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="1 4 1 10 7 10"></polyline>
                        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                    </svg>
                </button>
            </div>
        </div>

        <div id="raceProgress" class="race-progress" style="display: none;">
            <h3 class="race-title">üèÜ Race Progress</h3>
            <div id="raceProgressBars"></div>
        </div>

        <div class="game-content">
            <div class="flag-container" id="flagContainer" draggable="true">
                <span style="font-size: 2rem;">üö©</span>
            </div>

            <div class="board-container">
                <div class="board" id="board"></div>
            </div>

            <div id="gameOver" class="game-over" style="display: none;">
                <h3 class="game-over-title" id="gameOverTitle">üéâ YOU WIN! üéâ</h3>
                <p class="game-over-text" id="gameOverText"></p>
                <button class="replay-button" onclick="restartGame()">PLAY AGAIN</button>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>